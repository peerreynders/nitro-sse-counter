!function(){"use strict";
/*! (c) Andrea Giammarchi - ISC */const e=!0,t=!1,s="querySelectorAll",n="querySelectorAll",{document:r,Element:o,MutationObserver:i,Set:c,WeakMap:u}=self,a=e=>n in e,{filter:d}=[];const l=new Map,b=[],f=self.document,h=(l=>{const b=new u,f=(e,t)=>{let s;if(t)for(let n,r=(e=>e.matches||e.webkitMatchesSelector||e.msMatchesSelector)(e),o=0,{length:i}=v;o<i;o++)r.call(e,n=v[o])&&(b.has(e)||b.set(e,new c),s=b.get(e),s.has(n)||(s.add(n),l.handle(e,t,n)));else b.has(e)&&(s=b.get(e),b.delete(e),s.forEach((s=>{l.handle(e,t,s)})))},h=(e,t=!0)=>{for(let s=0,{length:n}=e;s<n;s++)f(e[s],t)},{query:v}=l,A=l.root||r,g=((n,r=document,o=MutationObserver,i=["*"])=>{const c=(t,r,o,i,u,a)=>{for(const d of t)(a||s in d)&&(u?o.has(d)||(o.add(d),i.delete(d),n(d,u)):i.has(d)||(i.add(d),o.delete(d),n(d,u)),a||c(d[s](r),r,o,i,u,e))},u=new o((s=>{if(i.length){const n=i.join(","),r=new Set,o=new Set;for(const{addedNodes:i,removedNodes:u}of s)c(u,n,r,o,t,t),c(i,n,r,o,e,t)}})),{observe:a}=u;return(u.observe=t=>a.call(u,t,{subtree:e,childList:e}))(r),u})(f,A,i,v),{attachShadow:m}=o.prototype;return m&&(o.prototype.attachShadow=function(e){const t=m.call(this,e);return g.observe(t),t}),v.length&&h(A[n](v)),{drop:e=>{for(let t=0,{length:s}=e;t<s;t++)b.delete(e[t])},flush:()=>{const e=g.takeRecords();for(let t=0,{length:s}=e;t<s;t++)h(d.call(e[t].removedNodes,a),!1),h(d.call(e[t].addedNodes,a),!0)},observer:g,parse:h}})({query:b,root:f,handle(e,t,s){const n=l.get(s);n&&(t?n.mounted:n.unmounted)?.(e)}}),v=(e,t)=>{const s="."+e;b.includes(s)||(b.push(s),l.set(s,t),h.parse(f.querySelectorAll(s)))},A={UNAVAILABLE:-1,WAIT:0,READY:1},g="js:c-count--disabled";function m(e,t){const s=new WeakMap,n={mounted(n){if(!(n instanceof HTMLElement))return;const r=function(e){const t=e.firstChild;if(t instanceof Text)return t;const s=new Text("");return t?e.replaceChild(s,t):e.appendChild(s),s}(n),o={root:n,text:r,disabled:n.classList.contains(g),unsubscribes:[]};o.unsubscribes[0]=e((e=>function(e,t){e.disabled||(e.text.nodeValue=String(t))}(o,e))),o.unsubscribes[1]=t((e=>function(e,t){const s=t===A.UNAVAILABLE;e.disabled!==s&&(e.disabled=s,e.root.classList.toggle(g,s))}(o,e))),s.set(n,o)},unmounted(e){const t=s.get(e);if(t){for(const e of t.unsubscribes)e();s.delete(e)}}};return n}const k="js:c-status--error",L=()=>{};function p(e){const t=new WeakMap;return{mounted(s){if(!(s instanceof HTMLParagraphElement))return;const n={root:s,text:new Text(""),unsubscribe:L};n.root.appendChild(n.text),n.unsubscribe=e((e=>function(e,t){e.root.classList.toggle(k,t.error),e.text.nodeValue=t.message}(n,e))),t.set(s,n)},unmounted(e){const s=t.get(e);s&&(s.unsubscribe(),t.delete(e))}}}const E="js:c-trigger--disabled",w="js:c-trigger--wait",S=()=>{};function N(e,t){const s=new WeakMap;return{mounted(n){if(!(n instanceof HTMLButtonElement))return;const r={root:n,disabled:!1,click:()=>{r.disabled||e()},unsubscribe:S};r.unsubscribe=t((e=>function(e,t){const[s,n]=t===A.READY?[!1,!1]:t===A.WAIT?[!0,!0]:[!0,!1];e.root.classList.toggle(w,n),e.disabled=s,e.root.classList.toggle(E,s),e.root.setAttribute("aria-disabled",String(s))}(r,e))),s.set(n,r),r.root.addEventListener("click",r.click)},unmounted(e){const t=s.get(e);t&&(t.unsubscribe(),t.root.removeEventListener("click",t.click),s.delete(e))}}}class M{sinks=new Set;clear(){this.clear}get size(){return this.sinks.size}add=e=>(this.sinks.add(e),()=>{this.sinks.delete(e)});send=e=>{for(const t of this.sinks)t(e)}}const y={kind:"end"},I={kind:"error",reason:"Failed to open connection"};function T(e,t){e.addEventListener("message",t),e.addEventListener("error",t)}function V(e){const t={status:void 0,href:e,sinks:new M,source:void 0,handleEvent(e){var t;if(!(this.sinks.size<1||!1===this.status))return e instanceof MessageEvent?(this.status=!0,void function(e,t){const s=Number(t.data);if(Number.isNaN(s))return;e({kind:"update",count:s})}(this.sinks.send,e)):void("error"===e.type&&(!0===this.status?this.sinks.send(y):this.sinks.send(I),(t=this).source&&(t.source.removeEventListener("message",t),t.source.removeEventListener("error",t),t.source.readyState<2&&t.source.close()),t.source=void 0,t.sinks.clear(),t.status=!1))}};return{start:()=>{t.source=new EventSource(t.href),t.sinks.size>0&&T(t.source,t)},subscribe:e=>{const s=t.sinks.size,n=t.sinks.add(e);return s<1&&t.source&&T(t.source,t),n}}}function j({inbound:e,outbound:t}){const s=function(){let e;return{send:t=>{e&&e(t)},subscribe:t=>(e=t,()=>{e===t&&(e=void 0)})}}(),n=function(e,t){let s={error:!0,message:"Connection failed. Reload to retry."};const n=new M,r={available:A.READY,sendAvailable:e=>{s&&(r.available=e,n.send(e),e===A.UNAVAILABLE&&(t(s),s=void 0,r.unsubscribe()))},subscribe:e=>{const t=n.add(e);return e(r.available),t},unsubscribe:(()=>{let t=e((function(e){switch(e.kind){case"end":return s={error:!1,message:"Count complete. Reload to restart."},void r.sendAvailable(A.UNAVAILABLE);case"error":return void r.sendAvailable(A.UNAVAILABLE);default:return void(r.available===A.WAIT&&r.sendAvailable(A.READY))}}));return()=>{t&&(t(),t=void 0)}})()};return r}(e.subscribe,s.send),r=function(e){let t;return{subscribe:e=>(t=e,()=>{t===e&&(t=void 0)}),unsubscribe:(()=>{let s=e((function(e){"update"===e.kind&&t&&t(e.count)}));return()=>{s&&(s(),s=void 0)}})()}}(e.subscribe),o=function(e,t){const s=e=>{e||t(A.UNAVAILABLE)};let n=!1;return{availableSink:e=>{n||e===A.UNAVAILABLE&&(n=!0)},unsubscribe:void 0,dispatch(){n||(t(A.WAIT),e().then(s))}}}(t.increment,n.sendAvailable);return o.unsubscribe=n.subscribe(o.availableSink),{increment:o.dispatch,start:e.start,subscribeAvailable:n.subscribe,subscribeStatus:s.subscribe,subscribeCount:r.subscribe}}var x,B;x=j({inbound:V("/api/counter"),outbound:(B="/api/increment",{increment:async()=>(await fetch(B,{method:"POST"})).ok})}),v("js\\:c-count",m(x.subscribeCount,x.subscribeAvailable)),v("js\\:c-status",p(x.subscribeStatus)),v("js\\:c-trigger",N(x.increment,x.subscribeAvailable)),x.start()}();
